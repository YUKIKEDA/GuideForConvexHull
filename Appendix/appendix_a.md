# 付録A 数学的補足

本付録では、凸包の理論を支える数学的な概念を、より厳密に整理します。第1章などで直感的に述べた定義を、形式的に明確にします。

---

## 凸集合の性質

### 定義の再掲

**定義（凸集合）**

$S \subseteq \mathbb{R}^d$ が**凸集合**であるとは、任意の $p, q \in S$ と任意の $t \in [0, 1]$ に対して

$$
(1-t)p + tq \in S
$$

が成り立つときを言う。つまり、$S$ 内の任意の2点を結ぶ線分が $S$ に含まれる。

### 凸集合の基本的な性質

| 性質 | 内容 |
|------|------|
| **凸集合の交叉** | 凸集合の族 $\{S_\alpha\}$ の共通部分 $\bigcap_\alpha S_\alpha$ は凸である |
| **凸集合の和** | 凸集合の和は一般に凸でない（線分が飛び出ることがある） |
| **アフィン写像** | 凸集合のアフィン変換（平行移動・回転・拡大縮小）の像は凸である |
| **凸包の特徴づけ** | 点集合 $P$ の凸包は、$P$ を含むすべての凸集合の交叉に一致する |

### 凸包の特徴づけ

$P \subseteq \mathbb{R}^d$ に対し、

$$
\mathrm{CH}(P) = \bigcap \{ C : C \text{ は凸集合かつ } P \subseteq C \}
$$

すなわち、$P$ を含む凸集合の**共通部分**が凸包 $\mathrm{CH}(P)$ である。これは「最小の凸集合」という直感的な定義を、集合論的に表現したものである。

### 凸包の別表現（凸結合）

凸包は、$P$ の点の**凸結合**（convex combination）全体としても表せる。

$$
\mathrm{CH}(P) = \left\{ \sum_{i=1}^{n} \lambda_i p_i : p_i \in P,\; \lambda_i \geq 0,\; \sum_{i=1}^{n} \lambda_i = 1 \right\}
$$

有限点集合 $P = \{p_1, \ldots, p_n\}$ の場合、凸包は「各点に非負の重みを付け、重みの和が 1 となるような重み付き和」全体の集合である。

---

## 極点（extreme point）の厳密な定義

### 定義

**定義（極点）**

凸集合 $S$ の点 $p$ が**極点**（extreme point）であるとは、$p$ が $S$ の異なる2点の**開線分**上に含まれないときを言う。

つまり、$p = (1-t)q + tr$ を満たす $q, r \in S$（$q \neq r$）と $t \in (0, 1)$ が存在しないとき、$p$ は極点である。

言い換えれば、$p$ は $S$ の「角」や「頂点」にあり、$p$ を通る $S$ 内の線分は $p$ のみを端点とする自明な線分（$q = r = p$）に限られる。

### 凸包との関係

- 凸多面体（凸包）の**頂点**は、その凸集合の極点である
- 逆に、有界な凸多面体の極点は、その多面体の頂点に一致する
- 凸包アルゴリズムは、本質的に $P$ の点のうち**凸包の極点**を列挙している

### 2次元・3次元での対応

| 次元 | 極点の幾何的意味 |
|------|------------------|
| 2次元 | 凸多角形の頂点。辺の中点は極点ではない |
| 3次元 | 凸多面体の頂点。辺上や面上の点（頂点以外）は極点ではない |
| $d$ 次元 | 凸多面体の 0 次元面（頂点） |

---

## 分離超平面定理（参考）

凸集合と点、または2つの凸集合を「分離」する超平面の存在についての定理である。凸包の内外判定や、最適化理論の基礎となる。

### 点と凸集合の分離

**定理（点と凸集合の厳密分離）**

$S \subseteq \mathbb{R}^d$ を凸集合、$p \in \mathbb{R}^d$ を $S$ の外側の点（$p \notin S$）とする。このとき、$p$ と $S$ を**厳密に分離**する超平面が存在する。すなわち、あるベクトル $a \in \mathbb{R}^d$（零でない）と $b \in \mathbb{R}$ が存在し、

$$
a^\top p > b \quad \text{かつ} \quad \forall q \in S \colon a^\top q < b
$$

（または不等号の向きが逆）が成り立つ。

直感的には、凸集合の外にある点は、その点と凸集合の間に「板」を挟める、という意味である。

### 2つの凸集合の分離

**定理（2つの凸集合の分離）**

$S_1$, $S_2 \subseteq \mathbb{R}^d$ を互いに交わらない凸集合とする（$S_1 \cap S_2 = \emptyset$）。このとき、$S_1$ と $S_2$ を**分離**する超平面が存在する。すなわち、ある $a \in \mathbb{R}^d$（零でない）と $b \in \mathbb{R}$ が存在し、

$$
\forall p \in S_1 \colon a^\top p \leq b \quad \text{かつ} \quad \forall q \in S_2 \colon a^\top q \geq b
$$

が成り立つ。

### 凸包への応用

点 $p$ が凸包 $\mathrm{CH}(P)$ の外部にあるとき、分離超平面定理により、$p$ と $\mathrm{CH}(P)$ を分離する超平面が存在する。その超平面は、凸包の**あるファセット**の超平面と一致するか、それに平行である。この事実は、凸包の内外判定（点が凸包の内部にあるかどうか）のアルゴリズムの正当性の根拠の一つとなる。

---

## 本章のまとめ

- **凸集合**は、任意の2点を結ぶ線分を含む集合である。凸包は $P$ を含む凸集合の共通部分として特徴づけられる。
- **極点**は、凸集合の異なる2点の開線分上に含まれない点であり、凸多面体の頂点に対応する。
- **分離超平面定理**は、凸集合の外側の点や、交わらない2つの凸集合を超平面で分離できることを保証する。
